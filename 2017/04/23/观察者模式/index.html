<!DOCTYPE html>
<html lang="zh">
    <head>
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.4 -->

    <!-- Title -->
    
    <title>
        
            观察者模式 | 
        
        游思达的博客
    </title>

    <!-- Meta & Info -->
    <meta charset="utf-8">

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
    
    
    

    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="游思达">
    <meta name="description" content="落霞与孤鹜齐飞，秋水共长天一色。">
    <meta name="keywords" content="null">

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="游思达的博客">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://yoursite.com">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="观察者模式 | 游思达的博客">
    <meta property="og:description" content="落霞与孤鹜齐飞，秋水共长天一色。">
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS & jQuery -->
    
        <link rel="stylesheet" href="/css/material.min.css">
        <link rel="stylesheet" href="/css/style.min.css">
        <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


        <script src="/js/jquery.min.js"></script>
        <script src="/js/queue.js"></script>
    

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    


    <!-- Bing Background -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#问题"><span class="post-toc-number">1.</span> <span class="post-toc-text">问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#认识观察者模式"><span class="post-toc-number">2.</span> <span class="post-toc-text">认识观察者模式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#观察者模式定义"><span class="post-toc-number">3.</span> <span class="post-toc-text">观察者模式定义</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#设计气象站"><span class="post-toc-number">4.</span> <span class="post-toc-text">设计气象站</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#实现气象站"><span class="post-toc-number">5.</span> <span class="post-toc-text">实现气象站</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#主题接口、观察者接口和布告栏接口"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">主题接口、观察者接口和布告栏接口</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#WeatherData-实现Subject接口"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">WeatherData(实现Subject接口)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#目前状态的布告栏"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">目前状态的布告栏</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#测试"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">测试</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用Java内置的观察模式"><span class="post-toc-number">6.</span> <span class="post-toc-text">使用Java内置的观察模式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#利用内置观察者模式实现气象站"><span class="post-toc-number">7.</span> <span class="post-toc-text">利用内置观察者模式实现气象站</span></a></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script>
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                观察者模式
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/FaceImage.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>游思达</strong>
        <span>4月 23, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=观察者模式&url=http://yoursite.com//2017/04/23/观察者模式/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=观察者模式&url=http://yoursite.com//2017/04/23/观察者模式/index.html&via=游思达" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com//2017/04/23/观察者模式/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://yoursite.com//2017/04/23/观察者模式/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>假设你的团队需要建立气象观测站，你需要建立WeatherData对象用于追踪目前的天气状态（温度、湿度和气压），同时有三个布告板显示当前状态，气象统计和简单预报，且布告板数量可以增加。</p>
<p>我们可以知道，此系统中有三个部分—–气象站（获得气象的物理装置），WeatherData对象（追踪气象站的数据，并更新布告板）和布告板（显示天气状态），如下图：</p>
<p><img src="\img\设计模式\9.png" alt="image"></p>
<p>初始代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public class WeatherData&#123;</div><div class="line">       //这三个方法返回最新的温度、湿度和气压.</div><div class="line">       //我们并不需要知道怎么得到数据.</div><div class="line">       public void getTemperature()&#123;&#125;</div><div class="line">       public void getHumidity()&#123;&#125;</div><div class="line">       public void getPressure()&#123;&#125;</div><div class="line"></div><div class="line">       //一旦气象被更新.调用该方法.</div><div class="line">       public void measurementChanged()&#123;</div><div class="line">              //你的代码.</div><div class="line">       &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们可能采用如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">       public void measurementChanged()&#123;</div><div class="line">       //调用getter()方法获取最新的测量值.</div><div class="line">       float temperature=getTemperature();</div><div class="line">       float humidity=getHumidity();</div><div class="line">       float pressure=getPressure();</div><div class="line"></div><div class="line">       //更新每个布告板上的内容.</div><div class="line">       currentConditionDisplay.update(temperature,humidity,pressure);</div><div class="line">       statisticsDisplay.update(temperature,humidity,pressure);</div><div class="line">       forecastDisplay.update(tempreature,humidity,pressure);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们会发现如下问题：</p>
<ul>
<li>布告栏的更新方法一样。</li>
<li>如果增加布告栏会修改代码。</li>
</ul>
<h3 id="认识观察者模式"><a href="#认识观察者模式" class="headerlink" title="认识观察者模式"></a>认识观察者模式</h3><p>来看看报纸和杂志的订阅:</p>
<ul>
<li>报社的业务是出版报纸。</li>
<li>向报社订阅报纸时，只要有新报纸，会给你送来。</li>
<li>当你取消订阅后，不会有新报纸给你送来。</li>
<li>只要报社还在运营，就会有人向他们订阅报纸或取消订阅。</li>
</ul>
<p>在观察者模式中，出版社称为主题，订阅者称为观察者，如图所示：</p>
<p><img src="\img\设计模式\10.png" alt="image"></p>
<h3 id="观察者模式定义"><a href="#观察者模式定义" class="headerlink" title="观察者模式定义"></a>观察者模式定义</h3><p>观察者模式定义对象之间一对多的依赖，当一个对象改变状态时，它的所有依赖者会收到通知并自动更新。</p>
<p><img src="\img\设计模式\11.png" alt="image"></p>
<h3 id="设计气象站"><a href="#设计气象站" class="headerlink" title="设计气象站"></a>设计气象站</h3><p><img src="\img\设计模式\12.png" alt="image"></p>
<h3 id="实现气象站"><a href="#实现气象站" class="headerlink" title="实现气象站"></a>实现气象站</h3><h4 id="主题接口、观察者接口和布告栏接口"><a href="#主题接口、观察者接口和布告栏接口" class="headerlink" title="主题接口、观察者接口和布告栏接口"></a>主题接口、观察者接口和布告栏接口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//主题接口.</div><div class="line">public interface Subject&#123;</div><div class="line">	//注册为观察者.</div><div class="line">	public void registerObserver(Observer o);</div><div class="line">	//移除观察者.</div><div class="line">	public void removeObserver(Observer o);</div><div class="line">	//通知观察者.</div><div class="line">	public void notifyObserver();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//观察者接口.</div><div class="line">public interface Observer&#123;</div><div class="line">	public void update(float temperature,float humidity,float pressure);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//布告栏接口.</div><div class="line">public interface DisplayElement&#123;</div><div class="line">	public void display();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="WeatherData-实现Subject接口"><a href="#WeatherData-实现Subject接口" class="headerlink" title="WeatherData(实现Subject接口)"></a>WeatherData(实现Subject接口)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">public class WeatherData implements Subject&#123;</div><div class="line">	</div><div class="line">	//三个状态变量.</div><div class="line">	private float temperature;</div><div class="line">	private float humidity;</div><div class="line">	private float pressure;</div><div class="line">	</div><div class="line">	//观察者队列.</div><div class="line">	private ArrayList observers;</div><div class="line">	</div><div class="line">	//构造函数中初始化ArrayList.</div><div class="line">	public WeatherData()&#123;</div><div class="line">		observers=new ArrayList();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	//注册观察者时.加入到ArrayList中.</div><div class="line">	@Override</div><div class="line">	public void registerObserver(Observer o)&#123;</div><div class="line">		observers.add(o);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	//删除观察者时.从ArrayList中移除.</div><div class="line">	@Override</div><div class="line">	public void removeObserver(Observer o)&#123;</div><div class="line">		int i=observers.indexOf(o);</div><div class="line">		if(i&gt;0)</div><div class="line">			observers.remove(i);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	//通知.</div><div class="line">	@Override</div><div class="line">	public void notifyObserver()&#123;</div><div class="line">		for(int i=0;i&lt;observers.size();i++)&#123;</div><div class="line">			Observer o=(Observer)observers.get(i);</div><div class="line">			o.update(temperature,humidity,pressure);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	//当气象站获得最新观察数据时.通知每一位观察者.</div><div class="line">	public void measurementsChanged()&#123;</div><div class="line">		notifyObserver();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	//模拟更新数据.</div><div class="line">	public void setMeasurements(float temperature,float humidity,float pressure)&#123;</div><div class="line">		this.temperature=temperature;</div><div class="line">		this.humidity=humidity;</div><div class="line">		this.pressure=pressure;</div><div class="line">		</div><div class="line">		measurementsChanged();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="目前状态的布告栏"><a href="#目前状态的布告栏" class="headerlink" title="目前状态的布告栏"></a>目前状态的布告栏</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">//当前状态布告栏.</div><div class="line">public class CurrentConditionsDisplay implements Observer,DisplayElement&#123;</div><div class="line"></div><div class="line">	//三个状态变量.</div><div class="line">	private float temperature;</div><div class="line">	private float humidity;</div><div class="line">	private float pressure;</div><div class="line">	</div><div class="line">	private Subject WeatherData;</div><div class="line">	</div><div class="line">	//构造函数中将当前实例注册为观察者.</div><div class="line">	public CurrentConditionsDisplay(Subject WeatherData)&#123;</div><div class="line">		 this.WeatherData=WeatherData;</div><div class="line">		 WeatherData.registerObserver(this);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	@Override</div><div class="line">	public void display()&#123;	</div><div class="line">		System.out.println(&quot;当前的温度&quot;+temperature+&quot; 湿度&quot;+humidity+&quot; 气压&quot;+pressure);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	//更新完后显示.</div><div class="line">	@Override</div><div class="line">	public void update(float temperature,float humidity,float pressure)&#123;</div><div class="line">		this.temperature=temperature;</div><div class="line">		this.humidity=humidity;</div><div class="line">		this.pressure=pressure;</div><div class="line">		display();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">public class Test&#123;</div><div class="line">	public static void main(String[] args)&#123;</div><div class="line">		</div><div class="line">		WeatherData weatherData=new WeatherData();</div><div class="line">		</div><div class="line">		//创建CurrentConditionsDisplay对象时会注册为观察者.</div><div class="line">		CurrentConditionsDisplay currentConditionDisplay=</div><div class="line">				new CurrentConditionsDisplay(weatherData);</div><div class="line">		</div><div class="line">		//模拟更新数据.</div><div class="line">		weatherData.setMeasurements(10,20,30);</div><div class="line">		weatherData.setMeasurements(20,30,40);</div><div class="line">		weatherData.setMeasurements(30,40,50);</div><div class="line">		</div><div class="line">		//输出.</div><div class="line">		当前的温度10.0 湿度20.0 气压30.0</div><div class="line">		当前的温度20.0 湿度30.0 气压40.0</div><div class="line">		当前的温度30.0 湿度40.0 气压50.0</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="使用Java内置的观察模式"><a href="#使用Java内置的观察模式" class="headerlink" title="使用Java内置的观察模式"></a>使用Java内置的观察模式</h3><p>Java.Util内包含Observer接口和Observable类，和我们的Subject接口和Observer接口相似。</p>
<p><img src="\img\设计模式\13.png" alt="image"></p>
<p>与我们最大的不同是主题是一个类Observable（可观察者），我们不需要在WeatherData中实现注册、删除和通知，因为超类Observable中实现了这些方法。</p>
<p>如何把对象变为观察者？</p>
<p>实现Observer接口,调用Observalbe对象的addObserver()方法，</p>
<p>可观察者如何推送通知？</p>
<ul>
<li>继承Observable接口成为可观察者。</li>
<li>调用SetChanged()方法，标记状态已经改变的事实。</li>
<li>调用notifyObservers()方法中的一种方法。</li>
</ul>
<p>首先，需要继承Observable接口产生可观察类，然后，需要两个步骤：</p>
<ul>
<li>先调用setChanged()方法，标记状态已经改变的事实。</li>
<li>然后调用两种notifyObservers（）方法中的一种方法。</li>
</ul>
<h3 id="利用内置观察者模式实现气象站"><a href="#利用内置观察者模式实现气象站" class="headerlink" title="利用内置观察者模式实现气象站"></a>利用内置观察者模式实现气象站</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">public class WeatherData extends Observable&#123;</div><div class="line">	</div><div class="line">	//因为是继承了Observable类.所以我们不在需要写观察者的注册、删除和通知.</div><div class="line"></div><div class="line">	//三个变量.</div><div class="line">	private float temperature;</div><div class="line">	private float humidity;</div><div class="line">	private float pressure;</div><div class="line">	</div><div class="line">	//当气象站得到最新的观察数据.通知观察者.</div><div class="line">	public void measurementsChanged()&#123;</div><div class="line">		setChanged();</div><div class="line">		</div><div class="line">		//调用通知之前.需要调用setChanged确保状态已经改变.</div><div class="line">		notifyObservers();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public float getTemperature()&#123;</div><div class="line">		return temperature;</div><div class="line">	&#125;</div><div class="line">	public float getHumidity()&#123;</div><div class="line">		return humidity;</div><div class="line">	&#125;</div><div class="line">	public float getPressure()&#123;</div><div class="line">		return pressure;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	//为了模拟气象站发来的最新值.</div><div class="line">	public void setMeasurements(float temperature,float humidity,float pressure)&#123;</div><div class="line">		this.temperature=temperature;</div><div class="line">		this.humidity=humidity;</div><div class="line">		this.pressure=pressure;</div><div class="line">		</div><div class="line">		measurementsChanged();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">//当前状态布告栏.</div><div class="line">public class CurrentConditionsDisplay implements Observer,DisplayElement&#123;</div><div class="line"></div><div class="line">	//三个状态变量.</div><div class="line">	private float temperature;</div><div class="line">	private float humidity;</div><div class="line">	private float pressure;</div><div class="line">	</div><div class="line">	private Observable WeatherData;</div><div class="line">	</div><div class="line">	//构造函数中将当前实例注册为观察者.</div><div class="line">	public CurrentConditionsDisplay(Observable WeatherData)&#123;</div><div class="line">		 this.WeatherData=WeatherData;</div><div class="line">		 WeatherData.addObserver(this);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	@Override</div><div class="line">	public void display()&#123;	</div><div class="line">		System.out.println(&quot;当前的温度&quot;+temperature+&quot; 湿度&quot;+humidity+&quot; 气压&quot;+pressure);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	//更新完后显示.</div><div class="line">	@Override</div><div class="line">	public void update(Observable o,Object arg)&#123;</div><div class="line">		</div><div class="line">		if(o instanceof WeatherData)&#123;</div><div class="line">			//调用get()方法获得数据.</div><div class="line">			this.temperature=((WeatherData)o).getTemperature();</div><div class="line">			this.humidity=((WeatherData)o).getHumidity();</div><div class="line">			this.pressure=((WeatherData)o).getPressure();</div><div class="line">			display();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>输出结果不变，表明修改成功。</p>
<p>如果有多个观察者，输出次序可能不同，切记不要依赖观察者被通知的次序。</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    







                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/04/27/装饰者模式/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/04/10/策略模式/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/SideImage.jpg);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/FaceImage.jpg" alt="游思达's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        553408524@qq.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/05/">五月 2017<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Java-基础/">Java 基础<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/数据结构/">数据结构<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/设计模式/">设计模式<span class="sidebar_archives-count">5</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/yousida" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.svg);">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/you-si-da" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-zhihu.svg);">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
     --></a>
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;游思达的博客
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->

    <script src="/js/lazyload.min.js"></script>
    <script src="/js/js.min.js"></script>



    <script src="/js/nprogress.js"></script>


<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>
















<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script>
    <!-- Offer LazyLoad -->
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    <!-- Start Queue -->
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

                </main>
            </div>
        </body>
    
</html>
